{% extends 'base.html' %}
{% load static %}

{% block title %}Cè¨€èªå…¥é–€{% endblock %}

{% block body_class %}cstudy-unified-page{% endblock %}

{% block head %}
<style>
/* åŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ« */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    overflow-x: hidden;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

/* ãƒ‘ãƒ©ãƒ©ãƒƒã‚¯ã‚¹ãƒ¢ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ« */
.parallax-mode {
    display: block;
    position: relative;
    height: 600vh;
    width: 100%;
    scroll-behavior: smooth;
}

.background-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    z-index: 0;
    overflow: visible;
}

.path, .clouds {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    will-change: transform;
}

.path {
    background-image: url('{% static "img/parallax/backgrounds/path.png" %}');
    background-color: #4a5d23;
    z-index: 1;
}

.clouds {
    background-image: url('{% static "img/parallax/backgrounds/clouds.png" %}');
    z-index: 2;
    opacity: 0.7;
}
.kawada-character {
    position: fixed;
    bottom: 30%;
    left: 50%;
    transform: translateX(-50%);
    width: 150px;
    height: 150px;
    z-index: 3;
    transition: all 0.5s ease;
    overflow: hidden;
    border-radius: 10px;
}

.kawada-character img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    object-position: center;
    display: block;
}

/* ãƒ¬ãƒƒã‚¹ãƒ³ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ä¸€ç•ªä¸Š */
.lesson-sections {
    position: relative;
    z-index: 4;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ */
@media (max-width: 768px) {
    .kawada-character {
        width: 100px;
        height: 100px;
        bottom: 25%;
    }
}
</style>
{% endblock %}

{% block content %}

<!-- ãƒ‘ãƒ©ãƒ©ãƒƒã‚¯ã‚¹ãƒ¢ãƒ¼ãƒ‰ -->
<div id="parallax-mode" class="parallax-mode">
    <div class="background-container">
        <div class="path" id="path-bg"></div>
        <div class="clouds" id="clouds-bg"></div>
        
        <div class="kawada-character" id="kawada-char">
            <img src="{% static 'img/parallax/characters/kawada-sam.png' %}" 
                 width="150" 
                 height="150" 
                 alt="å·ç”°" 
                 id="kawada-img">
        </div>
    </div>

    <!-- ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ç”¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="lesson-sections" style="position: relative; z-index: 10;">
        <section style="min-height: 100vh; display: flex; align-items: center; justify-content: center;">
            <div style="background: rgba(255,255,255,0.9); padding: 40px; border-radius: 20px; text-align: center; max-width: 600px;">
                <h2>ğŸŒŸ Cè¨€èªã®ä¸–ç•Œã¸ã‚ˆã†ã“ã</h2>
                <p>ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ãªãŒã‚‰å·ç”°ã¨ä¸€ç·’ã«å­¦ç¿’ã®æ—…ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼</p>
            </div>
        </section>
        
        <section style="min-height: 100vh; display: flex; align-items: center; justify-content: center;">
            <div style="background: rgba(255,255,255,0.9); padding: 40px; border-radius: 20px; text-align: center; max-width: 600px;">
                <h2>ğŸ“š åŸºæœ¬æ¦‚å¿µ</h2>
                <p>Cè¨€èªã¯1972å¹´ã«é–‹ç™ºã•ã‚ŒãŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§ã™ã€‚<br>ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®åŸºç›¤ã¨ãªã‚‹é‡è¦ãªè¨€èªã§ã™ã€‚</p>
            </div>
        </section>
        
        <section style="min-height: 100vh; display: flex; align-items: center; justify-content: center;">
            <div style="background: rgba(255,255,255,0.9); padding: 40px; border-radius: 20px; text-align: center; max-width: 600px;">
                <h2>ğŸ’» Hello World</h2>
                <p>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ç¬¬ä¸€æ­©ï¼<br>ã¾ãšã¯å®šç•ªã®ã€ŒHello Worldã€ã‹ã‚‰å§‹ã‚ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p>
            </div>
        </section>
        
        <section style="min-height: 100vh; display: flex; align-items: center; justify-content: center;">
            <div style="background: rgba(255,255,255,0.9); padding: 40px; border-radius: 20px; text-align: center; max-width: 600px;">
                <h2>ğŸ”¢ å¤‰æ•°ã¨å‹</h2>
                <p>ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹å¤‰æ•°ã®æ¦‚å¿µã‚’å­¦ã³ã€<br>intã€floatã€charãªã©ã®åŸºæœ¬å‹ã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚</p>
            </div>
        </section>
        
        <section style="min-height: 100vh; display: flex; align-items: center; justify-content: center;">
            <div style="background: rgba(255,255,255,0.9); padding: 40px; border-radius: 20px; text-align: center; max-width: 600px;">
                <h2>ğŸ¯ å­¦ç¿’å®Œäº†ï¼</h2>
                <p>ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼<br>å·ç”°ã¨ä¸€ç·’ã«Cè¨€èªã®åŸºç¤ã‚’å­¦ã³ã¾ã—ãŸã€‚</p>
            </div>
        </section>
        
        <section style="min-height: 100vh; display: flex; align-items: center; justify-content: center;">
            <div style="background: rgba(255,255,255,0.9); padding: 40px; border-radius: 20px; text-align: center; max-width: 600px;">
                <h2>ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>
                <p>å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«æŒ‘æˆ¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼<br>å·ç”°ãŒã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚</p>
            </div>
        </section>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// çµ±åˆã•ã‚ŒãŸCè¨€èªå­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 
class UnifiedCStudy {
    constructor() {
        this.currentMode = 'parallax';
        this.currentLesson = null;
        this.lessonData = [];
        this.quizData = [];
        this.progress = 0;
        
        this.init();
    }
    
    async init() {
        this.initParallax(); // ãƒ‘ãƒ©ãƒ©ãƒƒã‚¯ã‚¹ã‚’è‡ªå‹•ã§åˆæœŸåŒ–
    }
    
    initParallax() {
        // ãƒ‘ãƒ©ãƒ©ãƒƒã‚¯ã‚¹ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        let ticking = false;
        
        const handleScroll = () => {
            if (!ticking) {
                requestAnimationFrame(() => {
                    const scrollY = window.scrollY;
                    console.log("ScrollY:", scrollY); // ãƒ‡ãƒãƒƒã‚°ç”¨
                    const pathBg = document.getElementById('path-bg');
                    const cloudsBg = document.getElementById('clouds-bg');
                    const kawadaChar = document.getElementById('kawada-char');
                    
                    // èƒŒæ™¯ã®ãƒ‘ãƒ©ãƒ©ãƒƒã‚¯ã‚¹åŠ¹æœ
                    if (pathBg) pathBg.style.transform = `translateY(${scrollY * 0.5}px)`;
                    if (cloudsBg) cloudsBg.style.transform = `translateY(${scrollY * 0.3}px)`;
                    
                    // å·ç”°ãŒé“ã‚’æ­©ã„ã¦ã„ã‚‹ã‚ˆã†ãªåŠ¹æœ
                    if (kawadaChar) {
                        const walkingOffset = Math.sin(scrollY * 0.02) * 5; // æ­©è¡Œã®ã‚ˆã†ãªå·¦å³ã®å‹•ã
                        kawadaChar.style.transform = `translateX(calc(-50% + ${walkingOffset}px)) translateY(${scrollY * 0.1}px)`;
                    }
                    
                    ticking = false;
                });
                ticking = true;
            }
        };
        
        window.addEventListener('scroll', handleScroll, { passive: true });
        
        // åˆæœŸè¡¨ç¤ºæ™‚ã«å°‘ã—ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã—ã¦å‹•ä½œã‚’åˆ†ã‹ã‚Šã‚„ã™ã
        setTimeout(() => {
            window.scrollTo({ top: 1 });
        }, 100);
    }
}

// åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', () => {
    new UnifiedCStudy();
});
</script>
{% endblock %}
